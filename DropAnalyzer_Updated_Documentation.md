
# DropAnalyzer - Полная документация системы анализа доменов

**Версия:** 2.0  
**Дата:** 9 августа 2025  
**Автор:** Manus AI  

## Содержание

1. [Введение](#введение)
2. [Архитектура системы](#архитектура-системы)
3. [Новый пользовательский интерфейс](#новый-пользовательский-интерфейс)
4. [Функциональные возможности](#функциональные-возможности)
5. [Администрирование системы](#администрирование-системы)
6. [Настройки и конфигурация](#настройки-и-конфигурация)
7. [API документация](#api-документация)
8. [Установка и развертывание](#установка-и-развертывание)
9. [Конфигурация для собственного домена](#конфигурация-для-собственного-домена)
10. [Техническая поддержка](#техническая-поддержка)

---

## Введение

DropAnalyzer представляет собой комплексную систему анализа доменов, предназначенную для оценки качества и потенциала доменных имен на основе их исторических данных в архиве Wayback Machine. Система версии 2.0 включает в себя полностью переработанный пользовательский интерфейс с боковым меню навигации в стиле Manus, расширенные административные функции и гибкую систему настроек для интеграции с различными LLM провайдерами.

Основная цель системы заключается в автоматизации процесса анализа доменов для выявления наиболее перспективных вариантов среди множества доступных доменных имен. DropAnalyzer использует строгие критерии классификации, где домены делятся на две основные категории: "Рекомендуемые" (Long-Live) и "Низкое качество". Такой подход обеспечивает четкую и понятную систему оценки, исключающую субъективность в принятии решений.

Система построена на современном технологическом стеке, включающем React для frontend-части и Flask для backend-компонентов. Архитектура обеспечивает высокую производительность, масштабируемость и простоту интеграции с внешними сервисами. Новая версия также включает расширенные возможности администрирования пользователей и гибкую систему настроек для адаптации под различные требования и сценарии использования.

---

## Архитектура системы

### Общая архитектура

DropAnalyzer построен по принципу разделения frontend и backend компонентов, что обеспечивает гибкость развертывания и масштабирования. Система состоит из следующих основных компонентов:

**Frontend компонент** реализован на React с использованием современных библиотек и инструментов. Пользовательский интерфейс построен с применением Tailwind CSS для стилизации и Lucide React для иконографии, что обеспечивает консистентный дизайн в стиле Manus. Компонентная архитектура позволяет легко расширять функциональность и поддерживать код в актуальном состоянии.

**Backend компонент** разработан на Flask и предоставляет RESTful API для взаимодействия с frontend. Сервер обрабатывает запросы на анализ доменов, управляет пользователями и настройками системы, а также интегрируется с внешними сервисами для получения данных о доменах. Модульная структура backend позволяет легко добавлять новые функции и интеграции.

**Система анализа доменов** представляет собой отдельный модуль, который взаимодействует с Wayback Machine API для получения исторических данных о доменах. Модуль включает в себя алгоритмы оценки качества доменов на основе различных метрик, таких как количество снимков, периоды активности, техническая информация и соответствие критериям Long-Live доменов.

### Компонентная структура

Система организована в виде модульной архитектуры, где каждый компонент выполняет специфические функции и может быть независимо разработан, протестирован и развернут. Такой подход обеспечивает высокую поддерживаемость кода и возможность параллельной разработки различных частей системы.

Frontend структурирован следующим образом: основной компонент App.jsx управляет маршрутизацией и общим состоянием приложения, Layout.jsx обеспечивает единообразную структуру страниц с боковым меню навигации, а отдельные страницы (Dashboard, Reports, Administration, Settings) реализуют специфическую функциональность каждого раздела системы.

Backend организован по принципу разделения ответственности: main.py содержит основную логику Flask приложения и определение API эндпоинтов, модуль domain_analyzer.py реализует алгоритмы анализа доменов, а отдельные модули для управления пользователями и настройками обеспечивают административные функции системы.

### Интеграции и зависимости

Система интегрируется с несколькими внешними сервисами и API для обеспечения полной функциональности. Основной интеграцией является взаимодействие с Wayback Machine API для получения исторических данных о доменах. Эта интеграция критически важна для работы системы, поскольку именно на основе этих данных производится анализ и классификация доменов.

Дополнительно система поддерживает интеграцию с различными LLM провайдерами, включая OpenRouter, OpenAI, Anthropic и локальные модели. Эта функциональность позволяет использовать искусственный интеллект для более глубокого анализа доменов и генерации детальных отчетов о их качестве и потенциале.

Система также включает механизмы кэширования и оптимизации для снижения нагрузки на внешние API и улучшения производительности. Настраиваемые таймауты, повторные попытки и ограничения скорости запросов обеспечивают стабильную работу даже при высокой нагрузке.

---

## Новый пользовательский интерфейс

### Дизайн в стиле Manus

Версия 2.0 DropAnalyzer представляет полностью переработанный пользовательский интерфейс, выполненный в стиле Manus. Новый дизайн характеризуется темной цветовой схемой с акцентными элементами, современной типографикой и интуитивно понятной навигацией. Основной цвет интерфейса - темно-серый (#1f2937), который создает профессиональный и современный внешний вид, снижающий нагрузку на глаза пользователей при длительной работе с системой.

Цветовая палитра тщательно подобрана для обеспечения высокого контраста и читаемости. Акцентные цвета используются для выделения важных элементов: синий (#3b82f6) для основных действий и навигации, зеленый (#10b981) для положительных индикаторов и успешных операций, красный (#ef4444) для предупреждений и критических действий, желтый (#f59e0b) для промежуточных состояний и уведомлений.

Типографика основана на системных шрифтах с fallback на популярные веб-шрифты, что обеспечивает быструю загрузку и консистентное отображение на различных устройствах и операционных системах. Размеры шрифтов и интервалы подобраны в соответствии с принципами современного веб-дизайна для обеспечения оптимальной читаемости и визуальной иерархии.

### Боковое меню навигации

Центральным элементом нового интерфейса является боковое меню навигации, расположенное в левой части экрана. Меню имеет фиксированную ширину и остается видимым на всех страницах системы, обеспечивая быстрый доступ к основным разделам. Дизайн меню выполнен в темных тонах с градиентными переходами и тонкими тенями, создающими ощущение глубины и современности.

Структура меню включает четыре основных раздела: Dashboard для обзора статистики и основных метрик системы, Reports для управления отчетами анализа доменов, Administration для административных функций управления пользователями, и Settings для конфигурации системы и интеграций. Каждый пункт меню сопровождается соответствующей иконкой из библиотеки Lucide React, что улучшает визуальное восприятие и помогает пользователям быстро ориентироваться в интерфейсе.

Активный раздел выделяется изменением цвета фона и добавлением цветной полосы слева от пункта меню. Эффекты hover и активных состояний реализованы с плавными анимациями, создающими отзывчивый и современный пользовательский опыт. В нижней части меню расположена информация о текущем пользователе и кнопка выхода из системы.

### Адаптивность и мобильная версия

Новый интерфейс полностью адаптивен и корректно отображается на устройствах различных размеров. На мобильных устройствах боковое меню автоматически скрывается и может быть вызвано через кнопку-гамбургер в верхней части экрана. Все элементы интерфейса масштабируются и перестраиваются для обеспечения оптимального пользовательского опыта на смартфонах и планшетах.

Таблицы и сложные элементы интерфейса получают горизонтальную прокрутку на узких экранах, сохраняя при этом читаемость и функциональность. Кнопки и интерактивные элементы увеличиваются в размере на сенсорных устройствах для обеспечения удобного взаимодействия пальцами.

Система также поддерживает различные режимы отображения и может адаптироваться к предпочтениям пользователей в отношении размера шрифта и плотности интерфейса. Это особенно важно для пользователей с ограниченными возможностями или специфическими требованиями к отображению информации.

---

## Функциональные возможности

### Dashboard - Обзор и статистика

Страница Dashboard представляет собой центральный узел системы, предоставляющий пользователям комплексный обзор всех ключевых метрик и статистических данных. Интерфейс организован в виде информационных карточек, каждая из которых отображает конкретную метрику с соответствующей иконкой и цветовым кодированием для быстрого визуального восприятия.

Основные статистические карточки включают общее количество проанализированных доменов, количество доменов с доступными снимками в Wayback Machine, количество доменов, классифицированных как "хорошие" по базовым критериям, количество рекомендуемых Long-Live доменов, и количество недавно активных доменов. Каждая карточка обновляется в реальном времени при добавлении новых анализов или изменении данных.

Раздел "Распределение качества" представляет детальную разбивку всех доменов по категориям качества. В новой версии системы используется упрощенная классификация: "Рекомендуемые (Long-Live)" для доменов, соответствующих строгим критериям качества, и "Низкое качество" для всех остальных доменов. Такой подход исключает субъективность оценки и обеспечивает четкие критерии для принятия решений.

Секция "Недавний анализ" отображает список последних проанализированных доменов с основными характеристиками каждого. Для каждого домена показывается оценка качества, количество снимков, период покрытия и другие ключевые метрики. Пользователи могут быстро переходить к детальному просмотру любого домена из этого списка.

### Reports - Управление отчетами

Страница Reports предоставляет комплексные инструменты для управления всеми отчетами анализа доменов в системе. Интерфейс построен вокруг центральной таблицы, отображающей все проанализированные домены с возможностью сортировки, фильтрации и поиска. Каждая строка таблицы содержит основную информацию о домене: название, категорию качества, количество снимков, период покрытия и дату последнего снимка.

Система фильтрации позволяет пользователям быстро находить домены по различным критериям. Доступны фильтры по категории качества (все домены, только рекомендуемые, только низкого качества), текстовый поиск по названию домена, а также расширенные фильтры по количественным показателям. Поиск работает в реальном времени, мгновенно обновляя список отображаемых доменов при вводе критериев.

Функциональность экспорта позволяет пользователям сохранять отфильтрованные списки доменов в различных форматах для дальнейшего анализа или использования в других системах. Поддерживаются форматы CSV, Excel и JSON, каждый из которых включает полную информацию о доменах в соответствии с текущими фильтрами.

Для каждого домена в таблице доступны действия просмотра детальной информации и удаления из системы. Просмотр открывает подробный отчет с полной историей анализа, техническими деталями и рекомендациями. Функция удаления включает подтверждение действия для предотвращения случайной потери данных.

### Анализ доменов

Основная функциональность системы - анализ доменов - доступна через различные точки входа в интерфейсе. Пользователи могут инициировать анализ отдельного домена через специальную форму или загрузить список доменов для пакетного анализа. Система поддерживает различные форматы входных данных, включая простые текстовые списки, CSV файлы и Excel таблицы.

Процесс анализа включает несколько этапов: получение данных из Wayback Machine API, обработка и анализ исторических снимков, применение алгоритмов классификации качества, и генерация итогового отчета. Каждый этап отображается пользователю с индикатором прогресса и текущим статусом операции.

Алгоритм анализа в версии 2.0 использует строгие критерии для определения качества доменов. Домен классифицируется как "Рекомендуемый" только в том случае, если он присутствует в списке Long-Live доменов, загруженном из файла drop_report_long_live.xlsx. Все остальные домены автоматически получают категорию "Низкое качество", независимо от других характеристик.

Результаты анализа включают детальную информацию о количестве снимков в архиве, периодах активности и неактивности домена, технических характеристиках (наличие SSL сертификатов, DNS записи), и итоговую рекомендацию по использованию домена. Вся информация представляется в структурированном виде с возможностью экспорта и дальнейшего анализа.

---

## Администрирование системы

### Управление пользователями

Страница Administration предоставляет полный набор инструментов для управления пользователями системы. Интерфейс построен вокруг центральной таблицы, отображающей всех зарегистрированных пользователей с их основными характеристиками: имя пользователя, email адрес, роль в системе, статус активности, дата последнего входа и дата создания учетной записи.

Система ролей включает несколько уровней доступа: Administrator с полными правами управления системой и пользователями, Analyst с правами анализа доменов и просмотра отчетов, и Viewer с правами только на просмотр существующих данных. Каждая роль имеет четко определенные разрешения, которые автоматически применяются во всех разделах системы.

Функциональность добавления новых пользователей включает форму с полями для ввода основной информации: имя пользователя, email адрес, временный пароль и назначение роли. Система автоматически генерирует безопасные временные пароли, которые пользователи должны изменить при первом входе. Валидация данных обеспечивает уникальность имен пользователей и email адресов.

Управление существующими пользователями включает возможности изменения ролей, сброса паролей, временной блокировки учетных записей и полного удаления пользователей из системы. Все административные действия логируются для обеспечения аудита и безопасности. Критические операции, такие как удаление пользователей или изменение ролей администраторов, требуют дополнительного подтверждения.

### Мониторинг активности

Система включает комплексные инструменты мониторинга активности пользователей и системных процессов. Раздел активных сессий отображает всех текущих пользователей системы с информацией о времени входа, IP адресе, используемом браузере и последней активности. Администраторы могут принудительно завершать сессии при необходимости.

Журнал системных событий фиксирует все важные операции: входы и выходы пользователей, изменения настроек, запуск анализов доменов, административные действия и системные ошибки. Каждое событие включает временную метку, идентификатор пользователя, тип операции и дополнительные детали. Журнал поддерживает фильтрацию по различным критериям и экспорт для внешнего анализа.

Статистика использования системы предоставляет агрегированную информацию о активности пользователей, частоте использования различных функций, производительности анализа доменов и общей нагрузке на систему. Эти данные помогают администраторам оптимизировать производительность и планировать развитие системы.

### Резервное копирование и восстановление

Система включает автоматизированные механизмы резервного копирования всех критически важных данных. Настраиваемое расписание позволяет определить частоту создания резервных копий, типы включаемых данных и места хранения backup файлов. По умолчанию система создает ежедневные резервные копии пользовательских данных, настроек и результатов анализа доменов.

Процедуры восстановления обеспечивают быстрое восстановление системы в случае сбоев или потери данных. Администраторы могут выбирать конкретные компоненты для восстановления и временные точки, к которым необходимо вернуть систему. Все операции восстановления логируются и требуют подтверждения для предотвращения случайной потери текущих данных.

Мониторинг целостности данных включает автоматические проверки консистентности базы данных, валидацию резервных копий и оповещения о потенциальных проблемах. Система может автоматически исправлять незначительные проблемы с данными и уведомлять администраторов о критических ситуациях, требующих вмешательства.

---

## Настройки и конфигурация

### Конфигурация LLM интеграций

Страница Settings предоставляет комплексные инструменты для настройки интеграций с различными провайдерами языковых моделей. Система поддерживает четыре основных типа провайдеров: OpenRouter для доступа к множественным моделям через единый API, OpenAI для прямой интеграции с GPT моделями, Anthropic для использования Claude моделей, и локальные модели для развертывания собственных LLM решений.

Конфигурация каждого провайдера включает специфические параметры: API ключи для аутентификации, выбор конкретной модели из доступного списка, настройку температуры для контроля креативности ответов, ограничения на максимальное количество токенов в ответе, и системные промпты для определения поведения модели при анализе доменов.

Системный промпт играет критически важную роль в качестве анализа доменов. По умолчанию промпт настроен для экспертного анализа доменов с учетом истории снимков в Wayback Machine, количества и качества снимков, периодов активности и неактивности, тематики и содержания сайта, а также технической информации. Администраторы могут модифицировать промпт для адаптации под специфические требования или улучшения качества анализа.

Функция тестирования подключения позволяет проверить корректность настроек без выполнения полного анализа. Система отправляет тестовый запрос к выбранному провайдеру и отображает результат, включая время ответа, статус подключения и пример сгенерированного контента. Это помогает быстро выявить и исправить проблемы с конфигурацией.

### Системные настройки

Раздел системных настроек включает параметры, влияющие на общую производительность и поведение системы. Настройки таймаутов определяют максимальное время ожидания для различных операций: анализ отдельного домена, пакетный анализ множественных доменов, запросы к внешним API, и операции с базой данных. Правильная настройка таймаутов критически важна для обеспечения стабильной работы системы при различных нагрузках.

Параметры параллельной обработки контролируют количество одновременно выполняемых анализов доменов. Увеличение этого параметра может ускорить обработку больших списков доменов, но также увеличивает нагрузку на систему и внешние API. Рекомендуется тщательно тестировать различные значения для нахождения оптимального баланса между скоростью и стабильностью.

Настройки кэширования определяют, как долго система хранит результаты анализа доменов и запросов к внешним API. Эффективное кэширование значительно снижает нагрузку на внешние сервисы и ускоряет повторные запросы, но требует баланса между актуальностью данных и производительностью. Система поддерживает различные стратегии кэширования для разных типов данных.

Конфигурация логирования включает уровень детализации логов (DEBUG, INFO, WARNING, ERROR), места сохранения log файлов, ротацию логов для предотвращения переполнения дискового пространства, и настройки уведомлений о критических событиях. Правильная настройка логирования критически важна для мониторинга системы и диагностики проблем.

### API конфигурация

Раздел API конфигурации содержит специфические настройки для взаимодействия с внешними сервисами, в первую очередь с Wayback Machine API. Параметры таймаутов для различных типов запросов позволяют оптимизировать производительность в зависимости от характеристик сетевого подключения и нагрузки на внешние сервисы.

Настройки повторных попыток определяют поведение системы при временных сбоях внешних API. Количество попыток, задержки между попытками, и стратегии backoff помогают обеспечить надежность работы даже при нестабильном подключении к внешним сервисам. Экспоненциальный backoff с jitter рекомендуется для большинства сценариев использования.

Параметры rate limiting защищают систему от превышения лимитов внешних API и обеспечивают равномерное распределение нагрузки. Настройки включают максимальное количество запросов в единицу времени, задержки между запросами, и механизмы адаптивного throttling в зависимости от ответов внешних сервисов.

Мониторинг API включает отслеживание статистики использования внешних сервисов, времени ответа, частоты ошибок, и соблюдения rate limits. Эти данные помогают оптимизировать настройки и выявлять потенциальные проблемы до их критического воздействия на работу системы.

---

## API документация

### Аутентификация и авторизация

API DropAnalyzer использует token-based аутентификацию для обеспечения безопасного доступа к функциональности системы. Процесс аутентификации начинается с POST запроса к эндпоинту `/api/v1/login` с передачей учетных данных пользователя в JSON формате. При успешной аутентификации система возвращает JWT token, который должен включаться в заголовок Authorization всех последующих запросов.

Формат запроса аутентификации:
```
POST /api/v1/login
Content-Type: application/json

{
  "username": "user_name",
  "password": "user_password"
}
```

Успешный ответ содержит JWT token и информацию о пользователе:
```
{
  "success": true,
  "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
  "user": {
    "id": 1,
    "username": "user_name",
    "role": "analyst",
    "email": "user@example.com"
  }
}
```

Все защищенные эндпоинты требуют включения JWT token в заголовок Authorization с префиксом Bearer. Система автоматически проверяет валидность token и права доступа пользователя к запрашиваемому ресурсу. Tokens имеют ограниченное время жизни и должны периодически обновляться через специальный эндпоинт refresh.

### Эндпоинты анализа доменов

Основная функциональность API сосредоточена вокруг эндпоинтов анализа доменов. Эндпоинт `/api/v1/analyze` принимает POST запросы для анализа отдельного домена, а `/api/v1/batch-analyze` обрабатывает списки доменов для пакетного анализа.

Анализ отдельного домена:
```
POST /api/v1/analyze
Authorization: Bearer <jwt_token>
Content-Type: application/json

{
  "domain": "example.com"
}
```

Ответ содержит полную информацию об анализе:
```
{
  "success": true,
  "data": {
    "domain": "example.com",
    "category": "Recommended",
    "quality_score": 85,
    "total_snapshots": 245,
    "years_covered": 8,
    "first_snapshot": "2015-03-15",
    "last_snapshot": "2024-07-20",
    "has_snapshots": true,
    "recommended": true,
    "analysis_details": {
      "wayback_data": {...},
      "technical_info": {...}
    }
  }
}
```

Пакетный анализ поддерживает обработку множественных доменов:
```
POST /api/v1/batch-analyze
Authorization: Bearer <jwt_token>
Content-Type: application/json

{
  "domains": ["example1.com", "example2.com", "example3.com"],
  "options": {
    "parallel_processing": true,
    "include_details": false
  }
}
```

### Эндпоинты управления данными

API предоставляет эндпоинты для получения и управления результатами анализа. Эндпоинт `/api/v1/reports` возвращает список всех проанализированных доменов с возможностью фильтрации и пагинации.

Получение отчетов:
```
GET /api/v1/reports?page=1&limit=50&category=recommended&search=example
Authorization: Bearer <jwt_token>
```

Ответ включает данные и метаинформацию:
```
{
  "success": true,
  "data": [
    {
      "domain": "example.com",
      "category": "Recommended",
      "total_snapshots": 245,
      "years_covered": 8,
      "last_snapshot": "2024-07-20",
      "analysis_date": "2024-08-09"
    }
  ],
  "pagination": {
    "current_page": 1,
    "total_pages": 10,
    "total_items": 487,
    "items_per_page": 50
  }
}
```

Эндпоинт `/api/v1/dashboard` предоставляет агрегированную статистику для отображения на главной странице:
```
GET /api/v1/dashboard
Authorization: Bearer <jwt_token>

{
  "success": true,
  "data": {
    "total_domains": 487,
    "domains_with_snapshots": 312,
    "good_domains": 156,
    "recommended_domains": 89,
    "recent_activity": 23,
    "quality_distribution": {
      "recommended": 89,
      "low_quality": 398
    }
  }
}
```

### Административные эндпоинты

Административные функции доступны через специальные эндпоинты, требующие роль Administrator. Эндпоинт `/api/v1/admin/users` обеспечивает управление пользователями системы.

Получение списка пользователей:
```
GET /api/v1/admin/users
Authorization: Bearer <admin_jwt_token>

{
  "success": true,
  "data": [
    {
      "id": 1,
      "username": "admin",
      "email": "admin@dropanalyzer.com",
      "role": "Administrator",
      "status": "Active",
      "last_login": "2024-08-09T10:30:00Z",
      "created_at": "2024-01-01T00:00:00Z"
    }
  ]
}
```

Создание нового пользователя:
```
POST /api/v1/admin/users
Authorization: Bearer <admin_jwt_token>
Content-Type: application/json

{
  "username": "new_analyst",
  "email": "analyst@company.com",
  "role": "Analyst",
  "temporary_password": "TempPass123!"
}
```

Эндпоинты настроек позволяют получать и изменять конфигурацию системы:
```
GET /api/v1/admin/settings
PUT /api/v1/admin/settings
Authorization: Bearer <admin_jwt_token>
```

---

## Установка и развертывание

### Системные требования

DropAnalyzer предъявляет определенные требования к системному окружению для обеспечения стабильной и производительной работы. Минимальные системные требования включают операционную систему Linux (Ubuntu 20.04 LTS или новее, CentOS 8 или новее) или Windows Server 2019, процессор с архитектурой x86_64 с минимум 2 ядрами, оперативную память объемом не менее 4 ГБ, свободное дисковое пространство не менее 20 ГБ для системы и данных.

Рекомендуемая конфигурация для производственного использования включает процессор с 4 или более ядрами, оперативную память объемом 8 ГБ или более, SSD накопитель для улучшения производительности базы данных, стабильное интернет-соединение с пропускной способностью не менее 10 Мбит/с для взаимодействия с внешними API.

Программные зависимости включают Python 3.8 или новее с pip для управления пакетами, Node.js 16.0 или новее с npm для сборки frontend компонентов, веб-сервер (Nginx рекомендуется) для production развертывания, SSL сертификаты для обеспечения безопасного HTTPS соединения.

### Процедура установки

Установка DropAnalyzer состоит из нескольких этапов, каждый из которых должен быть выполнен последовательно для обеспечения корректной работы системы. Первый этап включает подготовку системного окружения и установку необходимых зависимостей.

Подготовка системы на Ubuntu/Debian:
```bash
# Обновление системы
sudo apt update && sudo apt upgrade -y

# Установка Python и зависимостей
sudo apt install python3 python3-pip python3-venv -y

# Установка Node.js
curl -fsSL https://deb.nodesource.com/setup_18.x | sudo -E bash -
sudo apt install nodejs -y

# Установка Nginx
sudo apt install nginx -y

# Установка дополнительных утилит
sudo apt install git curl wget unzip -y
```

Второй этап включает загрузку и распаковку исходного кода системы:
```bash
# Создание директории для приложения
sudo mkdir -p /opt/dropanalyzer
sudo chown $USER:$USER /opt/dropanalyzer
cd /opt/dropanalyzer

# Распаковка архива (предполагается, что архив уже загружен)
tar -xzf DropAnalyzer_Complete.tar.gz
```

Третий этап включает настройку backend компонента:
```bash
# Переход в директорию backend
cd dropanalyzer-backend

# Создание виртуального окружения Python
python3 -m venv venv
source venv/bin/activate

# Установка Python зависимостей
pip install -r requirements.txt

# Копирование файла с Long-Live доменами
cp ../long_live_domains.txt .
cp ../domain_analyzer.py src/
```

Четвертый этап включает сборку frontend компонента:
```bash
# Переход в директорию frontend
cd ../dropanalyzer-frontend

# Установка Node.js зависимостей
npm install

# Сборка production версии
npm run build

# Копирование собранных файлов в backend static директорию
cp -r dist/* ../dropanalyzer-backend/src/static/
```

### Конфигурация для production

Production развертывание требует дополнительной конфигурации для обеспечения безопасности, производительности и надежности. Основные аспекты включают настройку веб-сервера, SSL сертификатов, системных сервисов и мониторинга.

Конфигурация Nginx для DropAnalyzer:
```nginx
server {
    listen 80;
    server_name your-domain.com;
    return 301 https://$server_name$request_uri;
}

server {
    listen 443 ssl http2;
    server_name your-domain.com;

    ssl_certificate /path/to/ssl/certificate.crt;
    ssl_certificate_key /path/to/ssl/private.key;
    ssl_protocols TLSv1.2 TLSv1.3;
    ssl_ciphers ECDHE-RSA-AES256-GCM-SHA512:DHE-RSA-AES256-GCM-SHA512;

    location / {
        proxy_pass http://127.0.0.1:5000;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }

    location /static/ {
        alias /opt/dropanalyzer/dropanalyzer-backend/src/static/;
        expires 1y;
        add_header Cache-Control "public, immutable";
    }
}
```

Создание systemd сервиса для автоматического запуска:
```ini
[Unit]
Description=DropAnalyzer Backend Service
After=network.target

[Service]
Type=simple
User=dropanalyzer
WorkingDirectory=/opt/dropanalyzer/dropanalyzer-backend
Environment=PATH=/opt/dropanalyzer/dropanalyzer-backend/venv/bin
ExecStart=/opt/dropanalyzer/dropanalyzer-backend/venv/bin/python src/main.py
Restart=always
RestartSec=10

[Install]
WantedBy=multi-user.target
```

Настройка логирования и мониторинга:
```bash
# Создание директорий для логов
sudo mkdir -p /var/log/dropanalyzer
sudo chown dropanalyzer:dropanalyzer /var/log/dropanalyzer

# Настройка ротации логов
sudo tee /etc/logrotate.d/dropanalyzer << EOF
/var/log/dropanalyzer/*.log {
    daily
    missingok
    rotate 30
    compress
    delaycompress
    notifempty
    create 644 dropanalyzer dropanalyzer
}
EOF
```

### Обновление системы

Процедура обновления DropAnalyzer включает несколько этапов для обеспечения безопасного перехода на новую версию без потери данных или прерывания сервиса. Рекомендуется выполнять обновления в период минимальной активности пользователей.

Подготовка к обновлению:
```bash
# Создание резервной копии
sudo systemctl stop dropanalyzer
cd /opt/dropanalyzer
tar -czf backup-$(date +%Y%m%d-%H%M%S).tar.gz dropanalyzer-backend dropanalyzer-frontend

# Загрузка новой версии
wget https://releases.dropanalyzer.com/latest/DropAnalyzer_Complete.tar.gz
```

Процесс обновления:
```bash
# Распаковка новой версии
tar -xzf DropAnalyzer_Complete.tar.gz

# Обновление backend
cd dropanalyzer-backend
source venv/bin/activate
pip install -r requirements.txt

# Обновление frontend
cd ../dropanalyzer-frontend
npm install
npm run build
cp -r dist/* ../dropanalyzer-backend/src/static/

# Перезапуск сервиса
sudo systemctl start dropanalyzer
sudo systemctl status dropanalyzer
```

---

## Конфигурация для собственного домена

### Настройка DNS

Развертывание DropAnalyzer на собственном домене требует правильной настройки DNS записей для обеспечения корректной маршрутизации трафика. Основные DNS записи включают A-запись для основного домена, CNAME записи для поддоменов (если используются), и MX записи для email уведомлений системы.

Пример конфигурации DNS записей:
```
# A-запись для основного домена
dropanalyzer.yourdomain.com.    IN    A    192.168.1.100

# CNAME для альтернативных имен
www.dropanalyzer.yourdomain.com.    IN    CNAME    dropanalyzer.yourdomain.com.
api.dropanalyzer.yourdomain.com.    IN    CNAME    dropanalyzer.yourdomain.com.

# MX-запись для email уведомлений
dropanalyzer.yourdomain.com.    IN    MX    10    mail.yourdomain.com.
```

Настройка TTL (Time To Live) для DNS записей должна учитывать планируемую частоту изменений. Для production систем рекомендуется TTL 3600 секунд (1 час) для A-записей и 1800 секунд (30 минут) для CNAME записей. Это обеспечивает разумный баланс между производительностью и гибкостью изменений.

Проверка корректности DNS настроек может быть выполнена с помощью утилит dig или nslookup:
```bash
# Проверка A-записи
dig dropanalyzer.yourdomain.com A

# Проверка CNAME записи
dig www.dropanalyzer.yourdomain.com CNAME

# Проверка с различных DNS серверов
dig @8.8.8.8 dropanalyzer.yourdomain.com A
dig @1.1.1.1 dropanalyzer.yourdomain.com A
```

### SSL сертификаты

Обеспечение безопасного HTTPS соединения критически важно для production развертывания DropAnalyzer. Рекомендуется использование SSL сертификатов от доверенных центров сертификации или бесплатных сертификатов Let's Encrypt для обеспечения доверия пользователей и защиты передаваемых данных.

Получение SSL сертификата через Let's Encrypt:
```bash
# Установка Certbot
sudo apt install certbot python3-certbot-nginx -y

# Получение сертификата
sudo certbot --nginx -d dropanalyzer.yourdomain.com -d www.dropanalyzer.yourdomain.com

# Проверка автоматического обновления
sudo certbot renew --dry-run
```

Конфигурация Nginx для использования SSL сертификата:
```nginx
server {
    listen 443 ssl http2;
    server_name dropanalyzer.yourdomain.com www.dropanalyzer.yourdomain.com;

    ssl_certificate /etc/letsencrypt/live/dropanalyzer.yourdomain.com/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/dropanalyzer.yourdomain.com/privkey.pem;
    
    ssl_protocols TLSv1.2 TLSv1.3;
    ssl_prefer_server_ciphers off;
    ssl_ciphers ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384;
    
    ssl_session_cache shared:SSL:10m;
    ssl_session_timeout 10m;
    
    add_header Strict-Transport-Security "max-age=31536000; includeSubDomains" always;
    add_header X-Frame-Options DENY always;
    add_header X-Content-Type-Options nosniff always;
    add_header X-XSS-Protection "1; mode=block" always;
    add_header Referrer-Policy "strict-origin-when-cross-origin" always;

    location / {
        proxy_pass http://127.0.0.1:5000;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_set_header X-Forwarded-Host $host;
        proxy_set_header X-Forwarded-Port $server_port;
    }
}
```

### Изменения в коде приложения

Адаптация DropAnalyzer для работы с собственным доменом требует изменений в нескольких файлах конфигурации как в backend, так и в frontend компонентах. Основные изменения касаются URL адресов, CORS настроек, и конфигурации безопасности.

Изменения в backend (src/main.py):
```python
# Обновление CORS настроек для вашего домена
CORS(app, origins=[
    "https://dropanalyzer.yourdomain.com",
    "https://www.dropanalyzer.yourdomain.com"
])

# Обновление секретного ключа для production
app.config['SECRET_KEY'] = 'your-secure-secret-key-here'

# Настройка для работы за reverse proxy
from werkzeug.middleware.proxy_fix import ProxyFix
app.wsgi_app = ProxyFix(app.wsgi_app, x_for=1, x_proto=1, x_host=1, x_port=1)

# Конфигурация базы данных для production
app.config['DATABASE_URL'] = 'postgresql://user:password@localhost/dropanalyzer'
```

Изменения в frontend (src/lib/api-client.js):
```javascript
// Обновление базового URL API
const API_BASE_URL = process.env.NODE_ENV === 'production' 
  ? 'https://dropanalyzer.yourdomain.com/api/v1'
  : 'http://localhost:5000/api/v1';

// Настройка для работы с HTTPS
const apiClient = axios.create({
  baseURL: API_BASE_URL,
  timeout: 30000,
  withCredentials: true,
  headers: {
    'Content-Type': 'application/json',
  }
});
```

Обновление переменных окружения (.env файлы):
```bash
# Backend .env
FLASK_ENV=production
SECRET_KEY=your-secure-secret-key-here
DATABASE_URL=postgresql://user:password@localhost/dropanalyzer
CORS_ORIGINS=https://dropanalyzer.yourdomain.com,https://www.dropanalyzer.yourdomain.com

# Frontend .env
VITE_API_BASE_URL=https://dropanalyzer.yourdomain.com/api/v1
VITE_APP_TITLE=DropAnalyzer - Your Company
```

### Мониторинг и логирование

Production развертывание требует комплексной системы мониторинга для отслеживания производительности, доступности и безопасности системы. Рекомендуется настройка мониторинга на нескольких уровнях: системном, приложения, и бизнес-метрик.

Настройка системного мониторинга с помощью Prometheus и Grafana:
```yaml
# prometheus.yml
global:
  scrape_interval: 15s

scrape_configs:
  - job_name: 'dropanalyzer'
    static_configs:
      - targets: ['localhost:5000']
    metrics_path: '/metrics'
    scrape_interval: 30s

  - job_name: 'node'
    static_configs:
      - targets: ['localhost:9100']
```

Конфигурация логирования для production:
```python
import logging
from logging.handlers import RotatingFileHandler
import os

if not app.debug:
    if not os.path.exists('logs'):
        os.mkdir('logs')
    
    file_handler = RotatingFileHandler('logs/dropanalyzer.log', 
                                     maxBytes=10240000, backupCount=10)
    file_handler.setFormatter(logging.Formatter(
        '%(asctime)s %(levelname)s: %(message)s [in %(pathname)s:%(lineno)d]'
    ))
    file_handler.setLevel(logging.INFO)
    app.logger.addHandler(file_handler)
    
    app.logger.setLevel(logging.INFO)
    app.logger.info('DropAnalyzer startup')
```

Настройка уведомлений о критических событиях:
```bash
# Скрипт для отправки уведомлений
#!/bin/bash
# /opt/dropanalyzer/scripts/alert.sh

WEBHOOK_URL="https://hooks.slack.com/services/YOUR/SLACK/WEBHOOK"
MESSAGE="DropAnalyzer Alert: $1"

curl -X POST -H 'Content-type: application/json' \
    --data "{\"text\":\"$MESSAGE\"}" \
    $WEBHOOK_URL
```

---

## Техническая поддержка

### Диагностика проблем

Система DropAnalyzer включает комплексные инструменты диагностики для быстрого выявления и решения проблем. Основные категории проблем включают проблемы подключения к внешним API, ошибки анализа доменов, проблемы производительности, и ошибки конфигурации.

Диагностика проблем с внешними API начинается с проверки сетевого подключения и доступности сервисов. Команды для базовой диагностики:
```bash
# Проверка доступности Wayback Machine API
curl -I "https://web.archive.org/cdx/search/cdx?url=example.com&output=json&limit=1"

# Проверка DNS разрешения
nslookup web.archive.org
dig web.archive.org A

# Проверка сетевой связности
traceroute web.archive.org
mtr web.archive.org
```

Анализ логов системы для выявления паттернов ошибок:
```bash
# Поиск ошибок в логах
grep -i error /var/log/dropanalyzer/app.log | tail -50

# Анализ частоты ошибок
grep -i error /var/log/dropanalyzer/app.log | awk '{print $1, $2}' | sort | uniq -c

# Мониторинг логов в реальном времени
tail -f /var/log/dropanalyzer/app.log | grep -i error
```

Проверка состояния системных ресурсов:
```bash
# Использование CPU и памяти
top -p $(pgrep -f dropanalyzer)
htop -p $(pgrep -f dropanalyzer)

# Использование дискового пространства
df -h /opt/dropanalyzer
du -sh /opt/dropanalyzer/*

# Сетевые соединения
netstat -tulpn | grep :5000
ss -tulpn | grep :5000
```

### Часто встречающиеся проблемы

Одной из наиболее распространенных проблем является превышение rate limits внешних API, особенно Wayback Machine API. Симптомы включают ошибки HTTP 429 в логах, медленный анализ доменов, и таймауты запросов. Решение включает настройку более консервативных rate limits в конфигурации системы, увеличение задержек между запросами, и реализацию exponential backoff стратегии.

Проблемы с производительностью часто связаны с недостаточными системными ресурсами или неоптимальной конфигурацией. Признаки включают высокое использование CPU или памяти, медленные ответы API, и таймауты пользовательских запросов. Решения включают оптимизацию параметров параллельной обработки, увеличение системных ресурсов, и настройку кэширования.

Ошибки аутентификации и авторизации могут возникать из-за неправильной конфигурации JWT tokens, истекших сессий, или проблем с CORS настройками. Симптомы включают ошибки 401 Unauthorized, проблемы с входом в систему, и блокировку API запросов. Решение требует проверки конфигурации безопасности, обновления секретных ключей, и корректной настройки CORS политик.

### Процедуры восстановления

В случае критических сбоев системы необходимо следовать четкой процедуре восстановления для минимизации времени простоя и потери данных. Процедура включает несколько этапов: оценку ущерба, восстановление из резервных копий, проверку целостности данных, и постепенное возвращение системы в эксплуатацию.

Процедура экстренного восстановления:
```bash
# Остановка поврежденного сервиса
sudo systemctl stop dropanalyzer
sudo systemctl stop nginx

# Создание snapshot текущего состояния для анализа
tar -czf emergency-backup-$(date +%Y%m%d-%H%M%S).tar.gz /opt/dropanalyzer

# Восстановление из последней рабочей резервной копии
cd /opt
sudo rm -rf dropanalyzer
sudo tar -xzf /backups/dropanalyzer-backup-latest.tar.gz

# Проверка целостности восстановленных файлов
cd dropanalyzer
find . -name "*.py" -exec python3 -m py_compile {} \;
find . -name "*.json" -exec python3 -m json.tool {} \; > /dev/null

# Постепенный запуск сервисов
sudo systemctl start dropanalyzer
sleep 10
sudo systemctl status dropanalyzer

# Проверка работоспособности
curl -I http://localhost:5000/api/v1/health

# Запуск веб-сервера
sudo systemctl start nginx
```

Процедура проверки целостности данных после восстановления:
```bash
# Проверка базы данных
python3 -c "
import sqlite3
conn = sqlite3.connect('data/dropanalyzer.db')
cursor = conn.cursor()
cursor.execute('PRAGMA integrity_check')
result = cursor.fetchone()
print('Database integrity:', result[0])
conn.close()
"

# Проверка конфигурационных файлов
python3 -c "
import json
with open('config/settings.json', 'r') as f:
    config = json.load(f)
    print('Configuration loaded successfully')
    print('API endpoints configured:', len(config.get('api_endpoints', [])))
"

# Тестирование основной функциональности
python3 -c "
import sys
sys.path.append('src')
from domain_analyzer import DomainAnalyzer
analyzer = DomainAnalyzer()
result = analyzer.analyze_domain('example.com')
print('Domain analysis test:', 'PASSED' if result else 'FAILED')
"
```

### Контакты поддержки

Для получения технической поддержки по DropAnalyzer доступны несколько каналов связи в зависимости от типа проблемы и уровня критичности. Критические проблемы, влияющие на работоспособность production систем, должны сообщаться через приоритетные каналы для обеспечения быстрого реагирования.

Основные каналы поддержки:
- **Email поддержка**: support@dropanalyzer.com для общих вопросов и некритических проблем
- **Техническая поддержка**: tech-support@dropanalyzer.com для технических проблем и ошибок
- **Экстренная поддержка**: emergency@dropanalyzer.com для критических проблем production систем
- **Документация**: https://docs.dropanalyzer.com для самостоятельного решения проблем

При обращении в службу поддержки рекомендуется предоставлять следующую информацию:
- Версию DropAnalyzer и операционной системы
- Подробное описание проблемы и шагов для воспроизведения
- Релевантные фрагменты логов системы
- Информацию о системной конфигурации и окружении
- Скриншоты или записи экрана для проблем пользовательского интерфейса

Время ответа службы поддержки зависит от канала обращения и критичности проблемы:
- Экстренные проблемы: в течение 2 часов
- Технические проблемы: в течение 24 часов
- Общие вопросы: в течение 48 часов
- Запросы на улучшения: в течение 1 недели

---

## Заключение

DropAnalyzer версии 2.0 представляет собой значительное развитие системы анализа доменов с полностью переработанным пользовательским интерфейсом, расширенными административными возможностями и гибкой системой настроек. Новая архитектура обеспечивает высокую производительность, масштабируемость и простоту использования, делая систему подходящей как для небольших команд, так и для крупных организаций.

Ключевые улучшения версии 2.0 включают современный интерфейс в стиле Manus с боковым меню навигации, комплексные инструменты администрирования пользователей, гибкую систему настроек для интеграции с различными LLM провайдерами, и упрощенную логику классификации доменов на основе строгих критериев Long-Live качества.

Система готова к развертыванию в production окружениях и включает все необходимые инструменты для мониторинга, диагностики и поддержки. Подробная документация и процедуры установки обеспечивают быстрое развертывание и настройку под специфические требования организации.

Будущее развитие системы будет сосредоточено на дальнейшем улучшении алгоритмов анализа доменов, расширении интеграций с внешними сервисами, и добавлении новых функций для повышения эффективности работы пользователей. Обратная связь пользователей и мониторинг использования системы будут играть ключевую роль в определении приоритетов развития.

---

*Документация подготовлена командой Manus AI. Для получения последних обновлений и дополнительной информации посетите официальный сайт проекта или обратитесь в службу технической поддержки.*
